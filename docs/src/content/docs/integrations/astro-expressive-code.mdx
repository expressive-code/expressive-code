---
title: Astro (astro-expressive-code)
---

[![NPM version](https://img.shields.io/npm/v/astro-expressive-code.svg)](https://www.npmjs.com/package/astro-expressive-code)

[![NPM downloads](https://img.shields.io/npm/dm/astro-expressive-code.svg)](https://npmjs.org/package/astro-expressive-code)

## What is this?

This package is an [Astro](https://astro.build/) integration to automatically render code blocks in any markdown / MDX content on your Astro site using Expressive Code.

## When should I use this?

When you're writing content for your Astro site in markdown / MDX and want to improve the design and functionality of all contained code blocks using Expressive Code.

## Installation

### Automatic installation using the Astro CLI (recommended)

1. Change into the directory of your Astro site. If you do not have an existing Astro site, first create a new one using `npm create astro@latest` (other package managers like `pnpm` and `yarn` are also supported).

2. Use Astro's CLI to install `astro-expressive-code`:

    ```bash
    # When using npm
    npx astro add astro-expressive-code

    # When using pnpm
    pnpm astro add astro-expressive-code

    # When using yarn
    yarn astro add astro-expressive-code
    ```

    Confirm all prompts to download this third-party integration and add it to your site's configuration.

3. You're done! ðŸŽ‰

### Manual installation

If you don't want to use the Astro CLI or encounter any issues, you can also install `astro-expressive-code` manually:

1. Add the package to your site's dependencies:

    ```bash
    # When using npm
    npm install astro-expressive-code

    # When using pnpm
    pnpm install astro-expressive-code

    # When using yarn
    yarn add astro-expressive-code
    ```

2. Add the integration to your site's configuration:

    ```js
    // astro.config.mjs
    import { defineConfig } from 'astro/config'
    import astroExpressiveCode from 'astro-expressive-code'

    export default defineConfig({
      integrations: [
        astroExpressiveCode(),
      ],
    })
    ```

3. You're done! ðŸŽ‰

## Usage in markdown / MDX documents

See our [Authoring Content](/guides/authoring-content/) guide for more information on how to use Expressive Code in markdown / MDX documents.

## Add your own features

Expressive Code was designed with extensibility in mind. You can add your own features by creating plugins. See the [plugin documentation](https://github.com/expressive-code/expressive-code/blob/main/packages/%40expressive-code/core/README.md#plugins) for more information.

## Configuration

In your Astro config file, you can pass an options object to the integration. This object allows you to configure Expressive Code:

```js
// astro.config.mjs
import { defineConfig } from 'astro/config'
import astroExpressiveCode from 'astro-expressive-code'

/** @type {import('astro-expressive-code').AstroExpressiveCodeOptions} */
const astroExpressiveCodeOptions = {
  // Example: Change the themes
  themes: ['dracula', 'solarized-light'],
}

export default defineConfig({
  integrations: [
    astroExpressiveCode(astroExpressiveCodeOptions),
  ],
})
```

The following options are available:

### `themes`

- Type: `ThemeObjectOrShikiThemeName[]`
- Default: `['github-dark', 'github-light']`

- The color themes that should be available for your code blocks.

  CSS variables will be generated for all themes, allowing to select the theme to display using CSS. If you specify one dark and one light theme, a `prefers-color-scheme` media query will also be generated by default. You can customize this to match your site's needs through the `useDarkModeMediaQuery` and `themeCssSelector` options.

  The following item types are supported in this array:
  - any theme name bundled with Shiki: `dark-plus`, `dracula-soft`, `dracula`, `github-dark-dimmed`, `github-dark`, `github-light`, `hc_light`, `light-plus`, `material-theme-darker`, `material-theme-lighter`, `material-theme-ocean`, `material-theme-palenight`, `material-theme`, `min-dark`, `min-light`, `monokai`, `nord`, `one-dark-pro`, `poimandres`, `rose-pine-dawn`, `rose-pine-moon`, `rose-pine`, `slack-dark`, `slack-ochin`, `solarized-dark`, `solarized-light`, `vitesse-dark`, `vitesse-light`
  - any theme object compatible with VS Code or Shiki (e.g. imported from an NPM theme package)
  - any ExpressiveCodeTheme instance (e.g. using `ExpressiveCodeTheme.fromJSONString(...)`
    to load a custom JSON/JSONC theme file yourself). See [`ExpressiveCodeTheme`](https://github.com/expressive-code/expressive-code/blob/main/packages/%40expressive-code/core/README.md#expressivecodetheme) for more information.

### `minSyntaxHighlightingColorContrast`

- Type: `number`
- Default: `5.5`

- Determines if Expressive Code should process the syntax highlighting colors of all themes to ensure an accessible minimum contrast ratio between foreground and background colors.

  The default value of `5.5` ensures a contrast ratio of at least 5.5:1. You can change the desired contrast ratio by providing another value, or turn the feature off by setting this option to `0`.

### `useDarkModeMediaQuery`

- Type: `boolean`
- Default: `true` if your `themes` option is set to one dark and one light theme (which is the default), and `false` otherwise

- Determines if CSS code is generated that uses a `prefers-color-scheme` media query to automatically switch between light and dark themes based on the user's system preferences.

### `themeCssRoot`

- Type: `string`
- Default: `':root'`

- Allows to customize the base selector used to scope theme-dependent CSS styles.

  By default, this selector is `:root`, which ensures that all required CSS variables are globally available.

### `themeCssSelector`

- Type: `((theme: ExpressiveCodeTheme, context: { styleVariants: StyleVariant[] }) => string | false) | false`
- Default:

  ```js
  (theme) => `[data-theme='${theme.name}']`
  ```

- Allows to customize the selectors used to manually switch between multiple themes.

  These selectors are useful if you want to allow your users to choose a theme instead of relying solely on the media query generated by `useDarkModeMediaQuery`.

  You can add a theme selector either to your `<html>` element (which is targeted by the `themeCssRoot` default value of `:root`), and/or any individual code block wrapper.

  For example, when using the default settings, selecting the theme `github-light` for the entire page would look like this:

  ```html
  <html data-theme="github-light">
  ```

  If your site's theme switcher requires a different approach, you can customize the selectors using this option. For example, if you want to use class names instead of a data attribute, you could set this option to a function that returns `.theme-${theme.name}` instead.

  If you want to prevent the generation of theme-specific CSS rules altogether, you can set this to `false` or return it from the function.

### `cascadeLayer`

- Type: `string`
- Default: `''`

- Allows to specify a CSS cascade layer name that should be used for all generated CSS styles.

  If you are using [cascade layers](https://developer.mozilla.org/en-US/docs/Learn/CSS/Building_blocks/Cascade_layers) on your site to control the order in which CSS rules are applied, set this option to a non-empty string, and Expressive Code will wrap all of its generated CSS styles in a `@layer` rule with the given name.

### `customizeTheme`

- Type: `((theme: ExpressiveCodeTheme) => ExpressiveCodeTheme | void)`
- Default: `undefined`

- This optional function is called once per theme during engine initialization with the loaded theme as its only argument.

  It allows customizing the loaded theme and can be used for various purposes:

  - You can change a theme's `name` property to influence the CSS needed to select it (e.g., when using the default settings for `themeCssRoot` and `themeCssSelector`, setting `theme.name = 'dark'` will allow theme selection using `<html data-theme="dark">`).
  - You can create color variations of themes by using `theme.applyHueAndChromaAdjustments()`.

  You can optionally return an `ExpressiveCodeTheme` instance from this function to replace the theme provided in the configuration. This allows you to create a copy of the theme and modify it without affecting the original instance.

### `useThemedScrollbars`

- Type: `boolean`
- Default: `true`

- Whether the themes are allowed to style the scrollbars.

  If set to `false`, scrollbars will be rendered using the browser's default style.

  Note that you can override the individual scrollbar colors defined by the theme using the `styleOverrides` option.

### `useThemedSelectionColors`

- Type: `boolean`
- Default: `false`

- Whether the themes are allowed to style selected text.

  By default, Expressive Code renders selected text in code blocks using the browser's default style to maximize accessibility. If you want your selections to be more colorful, you can set this option to `true` to allow using theme selection colors instead.

  Note that you can override the individual selection colors defined by the theme using the `styleOverrides` option.

### `styleOverrides`

- Type: `StyleOverrides`
- Default: `{}`

- An optional set of style overrides that can be used to customize the appearance of the rendered code blocks without having to write custom CSS.

  The root level of this nested object contains core styles like colors, fonts, paddings and more. Plugins can contribute their own style settings to this object as well. For example, if the `frames` plugin is enabled, you can override its `shadowColor` by setting `styleOverrides.frames.shadowColor` to a color value.

  If any of the settings are not given, default values will be used or derived from the theme.

  > **Note**:
  > If your site uses CSS variables for styling, you can also use these overrides to replace any core style with a CSS variable reference, e.g. `var(--your-css-var)`.

### `defaultLocale`

- Type: `string`
- Default: `en-US`

- The locale that should be used for text content. Defaults to `en-US`.

### `plugins`

- Type: `(ExpressiveCodePlugin | ExpressiveCodePlugin[])[]`
- Default: `[]`

- An optional array of plugins that should be used when rendering code blocks.

  To add a plugin, import its initialization function and call it inside this array.

  If the plugin has any configuration options, you can pass them to the initialization function as an object containing your desired property values.

  If any nested arrays are found inside the `plugins` array, they will be flattened before processing.

### `shiki`

- Type: `boolean`
- Default: `true`

- Configures the Shiki plugin, which adds syntax highlighting to code blocks. You can set this to `false` to disable it.

### `textMarkers`

- Type: `boolean`
- Default: `true`

- Configures the Text Markers plugin, which allows to highlight lines and inline ranges in code blocks in various styles (e.g. marked, inserted, deleted).

  This plugin is enabled by default. Set this to `false` to disable it.

### `frames`

- Type: `PluginFramesOptions | boolean`
- Default: `true`

- Configures the Frames plugin, which adds an editor or terminal frame around code blocks, including an optional title displayed as a tab or window caption.

  This plugin is enabled by default. Set this to `false` to disable it.

  You can also configure the plugin by setting this to an [options object](https://github.com/expressive-code/expressive-code/blob/main/packages/%40expressive-code/plugin-frames/README.md#available-plugin-options).
