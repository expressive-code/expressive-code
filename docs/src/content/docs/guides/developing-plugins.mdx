---
title: Plugin Development
---

In Expressive Code, all processing of your code blocks and their metadata is performed by plugins and annotations. To render markup around lines or inline ranges of characters, plugins create annotations and attach them to the target lines.

## Using plugins

To add a plugin to your Expressive Code configuration, import its initialization function and call it inside the `plugins` array passed to the [ExpressiveCodeEngine constructor](/reference/core-api/#new-expressivecodeengineconfig).

If the plugin has any configuration options, you can pass them to the initialization function as an object containing your desired property values.

**Example**:

```js
import { ExpressiveCodeEngine } from '@expressive-code/core'
// Import the frames plugin
import { pluginFrames } from '@expressive-code/plugin-frames'

const engine = new ExpressiveCodeEngine({
  plugins: [
    // Add the plugin to the engine configuration
    pluginFrames({
      // Set the plugin's options (if any)
      extractFileNameFromCode: false,
    }),
  ],
})
```

## Writing your own plugins

To write a new plugin, you need to create a **plugin initialization function** that returns an object matching the interface [`ExpressiveCodePlugin`](/reference/plugin-api/#expressivecodeplugin).

```js
// my-example-plugin.js
export function pluginExample() {
  return {
    name: 'Example',
    hooks: {
      // Add your hooks here
    },
  }
}
```

If your plugin has any configuration options, you can add a single `options` argument to your initialization function. This argument must be an object type containing the desired configuration properties.

:::note
Please use sensible default values for all options wherever possible, so that users ideally do not need to pass any options for your plugin to work.
:::

## Adding CSS styles to your plugin

Plugins can add CSS styles by providing a [`baseStyles`](/reference/plugin-api/#basestyles) property in the plugin object returned by the plugin's initialization function.

### Automatic style scoping

All provided styles will be **scoped by default** to Expressive Code, so they will not affect the rest of the page. This means that you can define styles like `font-weight: 800`, or `del { text-decoration: line-through }`, and they will only apply to code blocks. SASS-like nesting is also supported.

If you explicitly want to add **global styles**, you can use the `@at-root` rule or target `:root`, `html` or `body` in your selectors. Please be careful with global styles, as users may not expect your plugin to contain a style like `body { color: red }` that changes the look of the entire page.

### Making your styles theme-dependent

If you want your CSS styles to use colors from the configured themes, you can add a [`styleSettings`](/reference/plugin-api/#stylesettings) property to your plugin object, which will be used to generate CSS variables automatically.

To use the generated CSS variables in your `baseStyles` property, set its value to a function instead of a string. The function will be called by the engine with a `context` argument of the type [`ResolverContext`](/reference/plugin-api/#resolvercontext) that provides access to the names of all generated CSS variables.
